{"ast":null,"code":"import React,{useState}from'react';import{useNavigate}from'react-router-dom';import'./LoginForm.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const LoginForm=()=>{const navigate=useNavigate();const[formData,setFormData]=useState({username:'',password:''});const[loading,setLoading]=useState(false);const[errorMessage,setErrorMessage]=useState('');const[userData,setUserData]=useState(null);const handleChange=e=>{setFormData({...formData,[e.target.name]:e.target.value});};const handleLoginSuccess=async userId=>{try{const userResponse=await fetch(\"/user/\".concat(userId),{method:'GET',headers:{'Content-Type':'application/json'}});if(userResponse.ok){const userData=await userResponse.json();console.log('User data:',userData);// Update the user data state and navigate to the user dashboard\nsetUserData(userData.user);navigate(\"/dashboard/\".concat(userId));}else{console.error('Error fetching user data:',userResponse.statusText);if(userResponse.status===500){setErrorMessage('Internal Server Error. Please try again later.');}else{setErrorMessage('Error fetching user data.');}}}catch(error){console.error('Error fetching user:',error);setErrorMessage('Something went wrong. Please try again.');}finally{setLoading(false);}};const handleSubmit=async e=>{e.preventDefault();try{setLoading(true);setErrorMessage('');const response=await fetch('/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(formData)});const data=await response.json();if(response.ok){console.log('Login successful:',data);if(!data.user||!data.user.id){setErrorMessage('User ID not found in the response.');return;}// Fetch user data after successful login\nhandleLoginSuccess(data.user.id);}else{console.error('Login failed:',data.message);setErrorMessage(data.message||'Login failed.');}}catch(error){console.error('Login failed',error);setErrorMessage('Something went wrong. Please try again.');}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"login-form-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Login\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"div\",{className:\"centered-input\",children:/*#__PURE__*/_jsxs(\"label\",{children:[\"Username:\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"username\",value:formData.username,onChange:handleChange})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"centered-input\",children:/*#__PURE__*/_jsxs(\"label\",{children:[\"Password:\",/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"password\",value:formData.password,onChange:handleChange})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"centered-input\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,children:loading?'Logging in...':'Login'})}),errorMessage&&/*#__PURE__*/_jsx(\"p\",{style:{color:'red'},children:errorMessage})]})]});};export default LoginForm;","map":{"version":3,"names":["React","useState","useNavigate","jsx","_jsx","jsxs","_jsxs","LoginForm","navigate","formData","setFormData","username","password","loading","setLoading","errorMessage","setErrorMessage","userData","setUserData","handleChange","e","target","name","value","handleLoginSuccess","userId","userResponse","fetch","concat","method","headers","ok","json","console","log","user","error","statusText","status","handleSubmit","preventDefault","response","body","JSON","stringify","data","id","message","className","children","onSubmit","type","onChange","disabled","style","color"],"sources":["/home/max/personal-projects/vaulted_wealth_frontend/src/components/login.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport './LoginForm.css'; \n\nconst LoginForm = () => {\n  const navigate = useNavigate();\n  const [formData, setFormData] = useState({\n    username: '',\n    password: '',\n  });\n  const [loading, setLoading] = useState(false);\n  const [errorMessage, setErrorMessage] = useState('');\n  const [userData, setUserData] = useState(null);\n\n  const handleChange = (e) => {\n    setFormData({ ...formData, [e.target.name]: e.target.value });\n  };\n\n  const handleLoginSuccess = async (userId) => {\n    try {\n      const userResponse = await fetch(`/user/${userId}`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      if (userResponse.ok) {\n        const userData = await userResponse.json();\n        console.log('User data:', userData);\n\n        // Update the user data state and navigate to the user dashboard\n        setUserData(userData.user);\n        navigate(`/dashboard/${userId}`);\n      } else {\n        console.error('Error fetching user data:', userResponse.statusText);\n\n        if (userResponse.status === 500) {\n          setErrorMessage('Internal Server Error. Please try again later.');\n        } else {\n          setErrorMessage('Error fetching user data.');\n        }\n      }\n    } catch (error) {\n      console.error('Error fetching user:', error);\n      setErrorMessage('Something went wrong. Please try again.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    try {\n      setLoading(true);\n      setErrorMessage('');\n\n      const response = await fetch('/login', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(formData),\n      });\n\n      const data = await response.json();\n\n      if (response.ok) {\n        console.log('Login successful:', data);\n\n        if (!data.user || !data.user.id) {\n          setErrorMessage('User ID not found in the response.');\n          return;\n        }\n\n        // Fetch user data after successful login\n        handleLoginSuccess(data.user.id);\n      } else {\n        console.error('Login failed:', data.message);\n        setErrorMessage(data.message || 'Login failed.');\n      }\n    } catch (error) {\n      console.error('Login failed', error);\n      setErrorMessage('Something went wrong. Please try again.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"login-form-container\">\n      <h2>Login</h2>\n      <form onSubmit={handleSubmit}>\n        {/* Add your existing form fields here */}\n        <div className=\"centered-input\">\n          <label>\n            Username:\n            <input\n              type=\"text\"\n              name=\"username\"\n              value={formData.username}\n              onChange={handleChange}\n            />\n          </label>\n        </div>\n        <div className=\"centered-input\">\n          <label>\n            Password:\n            <input\n              type=\"password\"\n              name=\"password\"\n              value={formData.password}\n              onChange={handleChange}\n            />\n          </label>\n        </div>\n        <div className=\"centered-input\">\n          <button type=\"submit\" disabled={loading}>\n            {loading ? 'Logging in...' : 'Login'}\n          </button>\n        </div>\n        {errorMessage && <p style={{ color: 'red' }}>{errorMessage}</p>}\n      </form>\n    </div>\n  );\n};\n\nexport default LoginForm;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}